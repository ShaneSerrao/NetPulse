async function post(u,b){const r=await fetch(u,{method:'POST',headers:{'Content-Type':'application/json'},credentials:'include',body:JSON.stringify(b)});if(!r.ok)throw new Error('Login failed');return r.json()}
document.getElementById('loginForm').addEventListener('submit',async e=>{e.preventDefault();const u=document.getElementById('u').value.trim();const p=document.getElementById('p').value;const t=document.getElementById('t').value.trim();try{await post('/api/auth/login',{username:u,password:p,totpCode:t||undefined});location.href='/'}catch{const el=document.getElementById('e');el.textContent='Invalid credentials';el.classList.remove('hidden')}})
